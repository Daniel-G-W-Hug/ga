#pragma once

// Copyright 2024-2025, Daniel Hug. All rights reserved.

#include "ga_prdxpr_common.hpp"

// pga3dp: projective geometric algebra with
//         e1*e1 = +1, e2*e2 = +1, e3*e3 = +1, e4*e4 = 0
// G(3,0,1)

// multivector basis components
const mvec_coeff mv3dp_basis = {"1",    "e1",   "e2",   "e3",   "e4",  "e41",
                                "e42",  "e43",  "e23",  "e31",  "e12", "e423",
                                "e431", "e412", "e321", "e1234"};

// rules to create produc tables (must contain space_str around operator_str on each side)
const prd_rules gpr_pga3dp_rules = {
    {"1 * 1", "1"},          {"1 * e1", "e1"},        {"1 * e2", "e2"},
    {"1 * e3", "e3"},        {"1 * e4", "e4"},        {"1 * e41", "e41"},
    {"1 * e42", "e42"},      {"1 * e43", "e43"},      {"1 * e23", "e23"},
    {"1 * e31", "e31"},      {"1 * e12", "e12"},      {"1 * e423", "e423"},
    {"1 * e431", "e431"},    {"1 * e412", "e412"},    {"1 * e321", "e321"},
    {"1 * e1234", "e1234"},

    {"e1 * 1", "e1"},        {"e1 * e1", "1"},        {"e1 * e2", "e12"},
    {"e1 * e3", "-e31"},     {"e1 * e4", "-e41"},     {"e1 * e41", "-e4"},
    {"e1 * e42", "-e412"},   {"e1 * e43", "e431"},    {"e1 * e23", "-e321"},
    {"e1 * e31", "-e3"},     {"e1 * e12", "e2"},      {"e1 * e423", "e1234"},
    {"e1 * e431", "e43"},    {"e1 * e412", "-e42"},   {"e1 * e321", "-e23"},
    {"e1 * e1234", "e423"},

    {"e2 * 1", "e2"},        {"e2 * e1", "-e12"},     {"e2 * e2", "1"},
    {"e2 * e3", "e23"},      {"e2 * e4", "-e42"},     {"e2 * e41", "e412"},
    {"e2 * e42", "-e4"},     {"e2 * e43", "-e423"},   {"e2 * e23", "e3"},
    {"e2 * e31", "-e321"},   {"e2 * e12", "-e1"},     {"e2 * e423", "-e43"},
    {"e2 * e431", "e1234"},  {"e2 * e412", "e41"},    {"e2 * e321", "-e31"},
    {"e2 * e1234", "e431"},

    {"e3 * 1", "e3"},        {"e3 * e1", "e31"},      {"e3 * e2", "-e23"},
    {"e3 * e3", "1"},        {"e3 * e4", "-e43"},     {"e3 * e41", "-e431"},
    {"e3 * e42", "e423"},    {"e3 * e43", "-e4"},     {"e3 * e23", "-e2"},
    {"e3 * e31", "e1"},      {"e3 * e12", "-e321"},   {"e3 * e423", "e42"},
    {"e3 * e431", "-e41"},   {"e3 * e412", "e1234"},  {"e3 * e321", "-e12"},
    {"e3 * e1234", "e412"},

    {"e4 * 1", "e4"},        {"e4 * e1", "e41"},      {"e4 * e2", "e42"},
    {"e4 * e3", "e43"},      {"e4 * e4", "0"},        {"e4 * e41", "0"},
    {"e4 * e42", "0"},       {"e4 * e43", "0"},       {"e4 * e23", "e423"},
    {"e4 * e31", "e431"},    {"e4 * e12", "e412"},    {"e4 * e423", "0"},
    {"e4 * e431", "0"},      {"e4 * e412", "0"},      {"e4 * e321", "e1234"},
    {"e4 * e1234", "0"},

    {"e41 * 1", "e41"},      {"e41 * e1", "e4"},      {"e41 * e2", "e412"},
    {"e41 * e3", "-e431"},   {"e41 * e4", "0"},       {"e41 * e41", "0"},
    {"e41 * e42", "0"},      {"e41 * e43", "0"},      {"e41 * e23", "-e1234"},
    {"e41 * e31", "-e43"},   {"e41 * e12", "e42"},    {"e41 * e423", "0"},
    {"e41 * e431", "0"},     {"e41 * e412", "0"},     {"e41 * e321", "-e423"},
    {"e41 * e1234", "0"},

    {"e42 * 1", "e42"},      {"e42 * e1", "-e412"},   {"e42 * e2", "e4"},
    {"e42 * e3", "e423"},    {"e42 * e4", "0"},       {"e42 * e41", "0"},
    {"e42 * e42", "0"},      {"e42 * e43", "0"},      {"e42 * e23", "e43"},
    {"e42 * e31", "-e1234"}, {"e42 * e12", "-e41"},   {"e42 * e423", "0"},
    {"e42 * e431", "0"},     {"e42 * e412", "0"},     {"e42 * e321", "-e431"},
    {"e42 * e1234", "0"},

    {"e43 * 1", "e43"},      {"e43 * e1", "e431"},    {"e43 * e2", "-e423"},
    {"e43 * e3", "e4"},      {"e43 * e4", "0"},       {"e43 * e41", "0"},
    {"e43 * e42", "0"},      {"e43 * e43", "0"},      {"e43 * e23", "-e42"},
    {"e43 * e31", "e41"},    {"e43 * e12", "-e1234"}, {"e43 * e423", "0"},
    {"e43 * e431", "0"},     {"e43 * e412", "0"},     {"e43 * e321", "-e412"},
    {"e43 * e1234", "0"},

    {"e23 * 1", "e23"},      {"e23 * e1", "-e321"},   {"e23 * e2", "-e3"},
    {"e23 * e3", "e2"},      {"e23 * e4", "e423"},    {"e23 * e41", "-e1234"},
    {"e23 * e42", "-e43"},   {"e23 * e43", "e42"},    {"e23 * e23", "-1"},
    {"e23 * e31", "-e12"},   {"e23 * e12", "e31"},    {"e23 * e423", "-e4"},
    {"e23 * e431", "-e412"}, {"e23 * e412", "e431"},  {"e23 * e321", "e1"},
    {"e23 * e1234", "e41"},

    {"e31 * 1", "e31"},      {"e31 * e1", "e3"},      {"e31 * e2", "-e321"},
    {"e31 * e3", "-e1"},     {"e31 * e4", "e431"},    {"e31 * e41", "e43"},
    {"e31 * e42", "-e1234"}, {"e31 * e43", "-e41"},   {"e31 * e23", "e12"},
    {"e31 * e31", "-1"},     {"e31 * e12", "-e23"},   {"e31 * e423", "e412"},
    {"e31 * e431", "-e4"},   {"e31 * e412", "-e423"}, {"e31 * e321", "e2"},
    {"e31 * e1234", "e42"},

    {"e12 * 1", "e12"},      {"e12 * e1", "-e2"},     {"e12 * e2", "e1"},
    {"e12 * e3", "-e321"},   {"e12 * e4", "e412"},    {"e12 * e41", "-e42"},
    {"e12 * e42", "e41"},    {"e12 * e43", "-e1234"}, {"e12 * e23", "-e31"},
    {"e12 * e31", "e23"},    {"e12 * e12", "-1"},     {"e12 * e423", "-e431"},
    {"e12 * e431", "e423"},  {"e12 * e412", "-e4"},   {"e12 * e321", "e3"},
    {"e12 * e1234", "e43"},

    {"e423 * 1", "e423"},    {"e423 * e1", "-e1234"}, {"e423 * e2", "-e43"},
    {"e423 * e3", "e42"},    {"e423 * e4", "0"},      {"e423 * e41", "0"},
    {"e423 * e42", "0"},     {"e423 * e43", "0"},     {"e423 * e23", "-e4"},
    {"e423 * e31", "-e412"}, {"e423 * e12", "e431"},  {"e423 * e423", "0"},
    {"e423 * e431", "0"},    {"e423 * e412", "0"},    {"e423 * e321", "e41"},
    {"e423 * e1234", "0"},

    {"e431 * 1", "e431"},    {"e431 * e1", "e43"},    {"e431 * e2", "-e1234"},
    {"e431 * e3", "-e41"},   {"e431 * e4", "0"},      {"e431 * e41", "0"},
    {"e431 * e42", "0"},     {"e431 * e43", "0"},     {"e431 * e23", "e412"},
    {"e431 * e31", "-e4"},   {"e431 * e12", "-e423"}, {"e431 * e423", "0"},
    {"e431 * e431", "0"},    {"e431 * e412", "0"},    {"e431 * e321", "e42"},
    {"e431 * e1234", "0"},

    {"e412 * 1", "e412"},    {"e412 * e1", "-e42"},   {"e412 * e2", "e41"},
    {"e412 * e3", "-e1234"}, {"e412 * e4", "0"},      {"e412 * e41", "0"},
    {"e412 * e42", "0"},     {"e412 * e43", "0"},     {"e412 * e23", "-e431"},
    {"e412 * e31", "e423"},  {"e412 * e12", "-e4"},   {"e412 * e423", "0"},
    {"e412 * e431", "0"},    {"e412 * e412", "0"},    {"e412 * e321", "e43"},
    {"e412 * e1234", "0"},

    {"e321 * 1", "e321"},    {"e321 * e1", "-e23"},   {"e321 * e2", "-e31"},
    {"e321 * e3", "-e12"},   {"e321 * e4", "-e1234"}, {"e321 * e41", "e423"},
    {"e321 * e42", "e431"},  {"e321 * e43", "e412"},  {"e321 * e23", "e1"},
    {"e321 * e31", "e2"},    {"e321 * e12", "e3"},    {"e321 * e423", "-e41"},
    {"e321 * e431", "-e42"}, {"e321 * e412", "-e43"}, {"e321 * e321", "-1"},
    {"e321 * e1234", "e4"},

    {"e1234 * 1", "e1234"},  {"e1234 * e1", "-e423"}, {"e1234 * e2", "-e431"},
    {"e1234 * e3", "-e412"}, {"e1234 * e4", "0"},     {"e1234 * e41", "0"},
    {"e1234 * e42", "0"},    {"e1234 * e43", "0"},    {"e1234 * e23", "e41"},
    {"e1234 * e31", "e42"},  {"e1234 * e12", "e43"},  {"e1234 * e423", "0"},
    {"e1234 * e431", "0"},   {"e1234 * e412", "0"},   {"e1234 * e321", "-e4"},
    {"e1234 * e1234", "0"}};

const prd_rules wdg_pga3dp_rules = {
    {"1 ^ 1", "1"},          {"1 ^ e1", "e1"},        {"1 ^ e2", "e2"},
    {"1 ^ e3", "e3"},        {"1 ^ e4", "e4"},        {"1 ^ e41", "e41"},
    {"1 ^ e42", "e42"},      {"1 ^ e43", "e43"},      {"1 ^ e23", "e23"},
    {"1 ^ e31", "e31"},      {"1 ^ e12", "e12"},      {"1 ^ e423", "e423"},
    {"1 ^ e431", "e431"},    {"1 ^ e412", "e412"},    {"1 ^ e321", "e321"},
    {"1 ^ e1234", "e1234"},

    {"e1 ^ 1", "e1"},        {"e1 ^ e1", "0"},        {"e1 ^ e2", "e12"},
    {"e1 ^ e3", "-e31"},     {"e1 ^ e4", "-e41"},     {"e1 ^ e41", "0"},
    {"e1 ^ e42", "-e412"},   {"e1 ^ e43", "e431"},    {"e1 ^ e23", "-e321"},
    {"e1 ^ e31", "0"},       {"e1 ^ e12", "0"},       {"e1 ^ e423", "e1234"},
    {"e1 ^ e431", "0"},      {"e1 ^ e412", "0"},      {"e1 ^ e321", "0"},
    {"e1 ^ e1234", "0"},

    {"e2 ^ 1", "e2"},        {"e2 ^ e1", "-e12"},     {"e2 ^ e2", "0"},
    {"e2 ^ e3", "e23"},      {"e2 ^ e4", "-e42"},     {"e2 ^ e41", "e412"},
    {"e2 ^ e42", "0"},       {"e2 ^ e43", "-e423"},   {"e2 ^ e23", "0"},
    {"e2 ^ e31", "-e321"},   {"e2 ^ e12", "0"},       {"e2 ^ e423", "0"},
    {"e2 ^ e431", "e1234"},  {"e2 ^ e412", "0"},      {"e2 ^ e321", "0"},
    {"e2 ^ e1234", "0"},

    {"e3 ^ 1", "e3"},        {"e3 ^ e1", "e31"},      {"e3 ^ e2", "-e23"},
    {"e3 ^ e3", "0"},        {"e3 ^ e4", "-e43"},     {"e3 ^ e41", "-e431"},
    {"e3 ^ e42", "e423"},    {"e3 ^ e43", "0"},       {"e3 ^ e23", "0"},
    {"e3 ^ e31", "0"},       {"e3 ^ e12", "-e321"},   {"e3 ^ e423", "0"},
    {"e3 ^ e431", "0"},      {"e3 ^ e412", "e1234"},  {"e3 ^ e321", "0"},
    {"e3 ^ e1234", "0"},

    {"e4 ^ 1", "e4"},        {"e4 ^ e1", "e41"},      {"e4 ^ e2", "e42"},
    {"e4 ^ e3", "e43"},      {"e4 ^ e4", "0"},        {"e4 ^ e41", "0"},
    {"e4 ^ e42", "0"},       {"e4 ^ e43", "0"},       {"e4 ^ e23", "e423"},
    {"e4 ^ e31", "e431"},    {"e4 ^ e12", "e412"},    {"e4 ^ e423", "0"},
    {"e4 ^ e431", "0"},      {"e4 ^ e412", "0"},      {"e4 ^ e321", "e1234"},
    {"e4 ^ e1234", "0"},

    {"e41 ^ 1", "e41"},      {"e41 ^ e1", "0"},       {"e41 ^ e2", "e412"},
    {"e41 ^ e3", "-e431"},   {"e41 ^ e4", "0"},       {"e41 ^ e41", "0"},
    {"e41 ^ e42", "0"},      {"e41 ^ e43", "0"},      {"e41 ^ e23", "-e1234"},
    {"e41 ^ e31", "0"},      {"e41 ^ e12", "0"},      {"e41 ^ e423", "0"},
    {"e41 ^ e431", "0"},     {"e41 ^ e412", "0"},     {"e41 ^ e321", "0"},
    {"e41 ^ e1234", "0"},

    {"e42 ^ 1", "e42"},      {"e42 ^ e1", "-e412"},   {"e42 ^ e2", "0"},
    {"e42 ^ e3", "e423"},    {"e42 ^ e4", "0"},       {"e42 ^ e41", "0"},
    {"e42 ^ e42", "0"},      {"e42 ^ e43", "0"},      {"e42 ^ e23", "0"},
    {"e42 ^ e31", "-e1234"}, {"e42 ^ e12", "0"},      {"e42 ^ e423", "0"},
    {"e42 ^ e431", "0"},     {"e42 ^ e412", "0"},     {"e42 ^ e321", "0"},
    {"e42 ^ e1234", "0"},

    {"e43 ^ 1", "e43"},      {"e43 ^ e1", "e431"},    {"e43 ^ e2", "-e423"},
    {"e43 ^ e3", "0"},       {"e43 ^ e4", "0"},       {"e43 ^ e41", "0"},
    {"e43 ^ e42", "0"},      {"e43 ^ e43", "0"},      {"e43 ^ e23", "0"},
    {"e43 ^ e31", "0"},      {"e43 ^ e12", "-e1234"}, {"e43 ^ e423", "0"},
    {"e43 ^ e431", "0"},     {"e43 ^ e412", "0"},     {"e43 ^ e321", "0"},
    {"e43 ^ e1234", "0"},

    {"e23 ^ 1", "e23"},      {"e23 ^ e1", "-e321"},   {"e23 ^ e2", "0"},
    {"e23 ^ e3", "0"},       {"e23 ^ e4", "e423"},    {"e23 ^ e41", "-e1234"},
    {"e23 ^ e42", "0"},      {"e23 ^ e43", "0"},      {"e23 ^ e23", "0"},
    {"e23 ^ e31", "0"},      {"e23 ^ e12", "0"},      {"e23 ^ e423", "0"},
    {"e23 ^ e431", "0"},     {"e23 ^ e412", "0"},     {"e23 ^ e321", "0"},
    {"e23 ^ e1234", "0"},

    {"e31 ^ 1", "e31"},      {"e31 ^ e1", "0"},       {"e31 ^ e2", "-e321"},
    {"e31 ^ e3", "0"},       {"e31 ^ e4", "e431"},    {"e31 ^ e41", "0"},
    {"e31 ^ e42", "-e1234"}, {"e31 ^ e43", "0"},      {"e31 ^ e23", "0"},
    {"e31 ^ e31", "0"},      {"e31 ^ e12", "0"},      {"e31 ^ e423", "0"},
    {"e31 ^ e431", "0"},     {"e31 ^ e412", "0"},     {"e31 ^ e321", "0"},
    {"e31 ^ e1234", "0"},

    {"e12 ^ 1", "e12"},      {"e12 ^ e1", "0"},       {"e12 ^ e2", "0"},
    {"e12 ^ e3", "-e321"},   {"e12 ^ e4", "e412"},    {"e12 ^ e41", "0"},
    {"e12 ^ e42", "0"},      {"e12 ^ e43", "-e1234"}, {"e12 ^ e23", "0"},
    {"e12 ^ e31", "0"},      {"e12 ^ e12", "0"},      {"e12 ^ e423", "0"},
    {"e12 ^ e431", "0"},     {"e12 ^ e412", "0"},     {"e12 ^ e321", "0"},
    {"e12 ^ e1234", "0"},

    {"e423 ^ 1", "e423"},    {"e423 ^ e1", "-e1234"}, {"e423 ^ e2", "0"},
    {"e423 ^ e3", "0"},      {"e423 ^ e4", "0"},      {"e423 ^ e41", "0"},
    {"e423 ^ e42", "0"},     {"e423 ^ e43", "0"},     {"e423 ^ e23", "0"},
    {"e423 ^ e31", "0"},     {"e423 ^ e12", "0"},     {"e423 ^ e423", "0"},
    {"e423 ^ e431", "0"},    {"e423 ^ e412", "0"},    {"e423 ^ e321", "0"},
    {"e423 ^ e1234", "0"},

    {"e431 ^ 1", "e431"},    {"e431 ^ e1", "0"},      {"e431 ^ e2", "-e1234"},
    {"e431 ^ e3", "0"},      {"e431 ^ e4", "0"},      {"e431 ^ e41", "0"},
    {"e431 ^ e42", "0"},     {"e431 ^ e43", "0"},     {"e431 ^ e23", "0"},
    {"e431 ^ e31", "0"},     {"e431 ^ e12", "0"},     {"e431 ^ e423", "0"},
    {"e431 ^ e431", "0"},    {"e431 ^ e412", "0"},    {"e431 ^ e321", "0"},
    {"e431 ^ e1234", "0"},

    {"e412 ^ 1", "e412"},    {"e412 ^ e1", "0"},      {"e412 ^ e2", "0"},
    {"e412 ^ e3", "-e1234"}, {"e412 ^ e4", "0"},      {"e412 ^ e41", "0"},
    {"e412 ^ e42", "0"},     {"e412 ^ e43", "0"},     {"e412 ^ e23", "0"},
    {"e412 ^ e31", "0"},     {"e412 ^ e12", "0"},     {"e412 ^ e423", "0"},
    {"e412 ^ e431", "0"},    {"e412 ^ e412", "0"},    {"e412 ^ e321", "0"},
    {"e412 ^ e1234", "0"},

    {"e321 ^ 1", "e321"},    {"e321 ^ e1", "0"},      {"e321 ^ e2", "0"},
    {"e321 ^ e3", "0"},      {"e321 ^ e4", "-e1234"}, {"e321 ^ e41", "0"},
    {"e321 ^ e42", "0"},     {"e321 ^ e43", "0"},     {"e321 ^ e23", "0"},
    {"e321 ^ e31", "0"},     {"e321 ^ e12", "0"},     {"e321 ^ e423", "0"},
    {"e321 ^ e431", "0"},    {"e321 ^ e412", "0"},    {"e321 ^ e321", "0"},
    {"e321 ^ e1234", "0"},

    {"e1234 ^ 1", "e1234"},  {"e1234 ^ e1", "0"},     {"e1234 ^ e2", "0"},
    {"e1234 ^ e3", "0"},     {"e1234 ^ e4", "0"},     {"e1234 ^ e41", "0"},
    {"e1234 ^ e42", "0"},    {"e1234 ^ e43", "0"},    {"e1234 ^ e23", "0"},
    {"e1234 ^ e31", "0"},    {"e1234 ^ e12", "0"},    {"e1234 ^ e423", "0"},
    {"e1234 ^ e431", "0"},   {"e1234 ^ e412", "0"},   {"e1234 ^ e321", "0"},
    {"e1234 ^ e1234", "0"}};

const prd_rules dot_pga3dp_rules = {
    {"1 * 1", "1"},        {"1 * e1", "0"},       {"1 * e2", "0"},
    {"1 * e3", "0"},       {"1 * e4", "0"},       {"1 * e41", "0"},
    {"1 * e42", "0"},      {"1 * e43", "0"},      {"1 * e23", "0"},
    {"1 * e31", "0"},      {"1 * e12", "0"},      {"1 * e423", "0"},
    {"1 * e431", "0"},     {"1 * e412", "0"},     {"1 * e321", "0"},
    {"1 * e1234", "0"},

    {"e1 * 1", "0"},       {"e1 * e1", "1"},      {"e1 * e2", "0"},
    {"e1 * e3", "0"},      {"e1 * e4", "0"},      {"e1 * e41", "0"},
    {"e1 * e42", "0"},     {"e1 * e43", "0"},     {"e1 * e23", "0"},
    {"e1 * e31", "0"},     {"e1 * e12", "0"},     {"e1 * e423", "0"},
    {"e1 * e431", "0"},    {"e1 * e412", "0"},    {"e1 * e321", "0"},
    {"e1 * e1234", "0"},

    {"e2 * 1", "0"},       {"e2 * e1", "0"},      {"e2 * e2", "1"},
    {"e2 * e3", "0"},      {"e2 * e4", "0"},      {"e2 * e41", "0"},
    {"e2 * e42", "0"},     {"e2 * e43", "0"},     {"e2 * e23", "0"},
    {"e2 * e31", "0"},     {"e2 * e12", "0"},     {"e2 * e423", "0"},
    {"e2 * e431", "0"},    {"e2 * e412", "0"},    {"e2 * e321", "0"},
    {"e2 * e1234", "0"},

    {"e3 * 1", "0"},       {"e3 * e1", "0"},      {"e3 * e2", "0"},
    {"e3 * e3", "1"},      {"e3 * e4", "0"},      {"e3 * e41", "0"},
    {"e3 * e42", "0"},     {"e3 * e43", "0"},     {"e3 * e23", "0"},
    {"e3 * e31", "0"},     {"e3 * e12", "0"},     {"e3 * e423", "0"},
    {"e3 * e431", "0"},    {"e3 * e412", "0"},    {"e3 * e321", "0"},
    {"e3 * e1234", "0"},

    {"e4 * 1", "0"},       {"e4 * e1", "0"},      {"e4 * e2", "0"},
    {"e4 * e3", "0"},      {"e4 * e4", "0"},      {"e4 * e41", "0"},
    {"e4 * e42", "0"},     {"e4 * e43", "0"},     {"e4 * e23", "0"},
    {"e4 * e31", "0"},     {"e4 * e12", "0"},     {"e4 * e423", "0"},
    {"e4 * e431", "0"},    {"e4 * e412", "0"},    {"e4 * e321", "0"},
    {"e4 * e1234", "0"},

    {"e41 * 1", "0"},      {"e41 * e1", "0"},     {"e41 * e2", "0"},
    {"e41 * e3", "0"},     {"e41 * e4", "0"},     {"e41 * e41", "0"},
    {"e41 * e42", "0"},    {"e41 * e43", "0"},    {"e41 * e23", "0"},
    {"e41 * e31", "0"},    {"e41 * e12", "0"},    {"e41 * e423", "0"},
    {"e41 * e431", "0"},   {"e41 * e412", "0"},   {"e41 * e321", "0"},
    {"e41 * e1234", "0"},

    {"e42 * 1", "0"},      {"e42 * e1", "0"},     {"e42 * e2", "0"},
    {"e42 * e3", "0"},     {"e42 * e4", "0"},     {"e42 * e41", "0"},
    {"e42 * e42", "0"},    {"e42 * e43", "0"},    {"e42 * e23", "0"},
    {"e42 * e31", "0"},    {"e42 * e12", "0"},    {"e42 * e423", "0"},
    {"e42 * e431", "0"},   {"e42 * e412", "0"},   {"e42 * e321", "0"},
    {"e42 * e1234", "0"},

    {"e43 * 1", "0"},      {"e43 * e1", "0"},     {"e43 * e2", "0"},
    {"e43 * e3", "0"},     {"e43 * e4", "0"},     {"e43 * e41", "0"},
    {"e43 * e42", "0"},    {"e43 * e43", "0"},    {"e43 * e23", "0"},
    {"e43 * e31", "0"},    {"e43 * e12", "0"},    {"e43 * e423", "0"},
    {"e43 * e431", "0"},   {"e43 * e412", "0"},   {"e43 * e321", "0"},
    {"e43 * e1234", "0"},

    {"e23 * 1", "0"},      {"e23 * e1", "0"},     {"e23 * e2", "0"},
    {"e23 * e3", "0"},     {"e23 * e4", "0"},     {"e23 * e41", "0"},
    {"e23 * e42", "0"},    {"e23 * e43", "0"},    {"e23 * e23", "1"},
    {"e23 * e31", "0"},    {"e23 * e12", "0"},    {"e23 * e423", "0"},
    {"e23 * e431", "0"},   {"e23 * e412", "0"},   {"e23 * e321", "0"},
    {"e23 * e1234", "0"},

    {"e31 * 1", "0"},      {"e31 * e1", "0"},     {"e31 * e2", "0"},
    {"e31 * e3", "0"},     {"e31 * e4", "0"},     {"e31 * e41", "0"},
    {"e31 * e42", "0"},    {"e31 * e43", "0"},    {"e31 * e23", "0"},
    {"e31 * e31", "1"},    {"e31 * e12", "0"},    {"e31 * e423", "0"},
    {"e31 * e431", "0"},   {"e31 * e412", "0"},   {"e31 * e321", "0"},
    {"e31 * e1234", "0"},

    {"e12 * 1", "0"},      {"e12 * e1", "0"},     {"e12 * e2", "0"},
    {"e12 * e3", "0"},     {"e12 * e4", "0"},     {"e12 * e41", "0"},
    {"e12 * e42", "0"},    {"e12 * e43", "0"},    {"e12 * e23", "0"},
    {"e12 * e31", "0"},    {"e12 * e12", "1"},    {"e12 * e423", "0"},
    {"e12 * e431", "0"},   {"e12 * e412", "0"},   {"e12 * e321", "0"},
    {"e12 * e1234", "0"},

    {"e423 * 1", "0"},     {"e423 * e1", "0"},    {"e423 * e2", "0"},
    {"e423 * e3", "0"},    {"e423 * e4", "0"},    {"e423 * e41", "0"},
    {"e423 * e42", "0"},   {"e423 * e43", "0"},   {"e423 * e23", "0"},
    {"e423 * e31", "0"},   {"e423 * e12", "0"},   {"e423 * e423", "0"},
    {"e423 * e431", "0"},  {"e423 * e412", "0"},  {"e423 * e321", "0"},
    {"e423 * e1234", "0"},

    {"e431 * 1", "0"},     {"e431 * e1", "0"},    {"e431 * e2", "0"},
    {"e431 * e3", "0"},    {"e431 * e4", "0"},    {"e431 * e41", "0"},
    {"e431 * e42", "0"},   {"e431 * e43", "0"},   {"e431 * e23", "0"},
    {"e431 * e31", "0"},   {"e431 * e12", "0"},   {"e431 * e423", "0"},
    {"e431 * e431", "0"},  {"e431 * e412", "0"},  {"e431 * e321", "0"},
    {"e431 * e1234", "0"},

    {"e412 * 1", "0"},     {"e412 * e1", "0"},    {"e412 * e2", "0"},
    {"e412 * e3", "0"},    {"e412 * e4", "0"},    {"e412 * e41", "0"},
    {"e412 * e42", "0"},   {"e412 * e43", "0"},   {"e412 * e23", "0"},
    {"e412 * e31", "0"},   {"e412 * e12", "0"},   {"e412 * e423", "0"},
    {"e412 * e431", "0"},  {"e412 * e412", "0"},  {"e412 * e321", "0"},
    {"e412 * e1234", "0"},

    {"e321 * 1", "0"},     {"e321 * e1", "0"},    {"e321 * e2", "0"},
    {"e321 * e3", "0"},    {"e321 * e4", "0"},    {"e321 * e41", "0"},
    {"e321 * e42", "0"},   {"e321 * e43", "0"},   {"e321 * e23", "0"},
    {"e321 * e31", "0"},   {"e321 * e12", "0"},   {"e321 * e423", "0"},
    {"e321 * e431", "0"},  {"e321 * e412", "0"},  {"e321 * e321", "1"},
    {"e321 * e1234", "0"},

    {"e1234 * 1", "0"},    {"e1234 * e1", "0"},   {"e1234 * e2", "0"},
    {"e1234 * e3", "0"},   {"e1234 * e4", "0"},   {"e1234 * e41", "0"},
    {"e1234 * e42", "0"},  {"e1234 * e43", "0"},  {"e1234 * e23", "0"},
    {"e1234 * e31", "0"},  {"e1234 * e12", "0"},  {"e1234 * e423", "0"},
    {"e1234 * e431", "0"}, {"e1234 * e412", "0"}, {"e1234 * e321", "0"},
    {"e1234 * e1234", "0"}};


// complement in 3dp: lcmpl(rcmpl(u)) = u
// lcmpl:  lcmpl(u) ^ u        = e1234
const prd_rules lcmpl_pga3dp_rules = {
    {"1", "e1234"},  {"e1", "-e423"}, {"e2", "-e431"}, {"e3", "-e412"},
    {"e4", "-e321"}, {"e41", "-e23"}, {"e42", "-e31"}, {"e43", "-e12"},
    {"e23", "-e41"}, {"e31", "-e42"}, {"e12", "-e43"}, {"e423", "e1"},
    {"e431", "e2"},  {"e412", "e3"},  {"e321", "e4"},  {"e1234", "1"}};
// rcmpl:  u        ^ rcmpl(u) = e1234
const prd_rules rcmpl_pga3dp_rules = {
    {"1", "e1234"},  {"e1", "e423"},  {"e2", "e431"},  {"e3", "e412"},
    {"e4", "e321"},  {"e41", "-e23"}, {"e42", "-e31"}, {"e43", "-e12"},
    {"e23", "-e41"}, {"e31", "-e42"}, {"e12", "-e43"}, {"e423", "-e1"},
    {"e431", "-e2"}, {"e412", "-e3"}, {"e321", "-e4"}, {"e1234", "1"}};

// rules needed to derive contractions and expansions using bulk_dual and weight_dual
// (derived from the right complement -> right bulk dual is equivalent to the Hodge dual)
const prd_rules right_bulk_dual_pga3dp_rules = {
    {"1", "e1234"},  {"e1", "e423"},  {"e2", "e431"},  {"e3", "e412"},
    {"e4", "0"},     {"e41", "0"},    {"e42", "0"},    {"e43", "0"},
    {"e23", "-e41"}, {"e31", "-e42"}, {"e12", "-e43"}, {"e423", "0"},
    {"e431", "0"},   {"e412", "0"},   {"e321", "-e4"}, {"e1234", "0"}};
const prd_rules right_weight_dual_pga3dp_rules = {
    {"1", "0"},      {"e1", "0"},     {"e2", "0"},     {"e3", "0"},
    {"e4", "e321"},  {"e41", "-e23"}, {"e42", "-e31"}, {"e43", "-e12"},
    {"e23", "0"},    {"e31", "0"},    {"e12", "0"},    {"e423", "-e1"},
    {"e431", "-e2"}, {"e412", "-e3"}, {"e321", "0"},   {"e1234", "1"}};

// (derived from the left complement)
const prd_rules left_bulk_dual_pga3dp_rules = {
    {"1", "e1234"},  {"e1", "-e423"}, {"e2", "-e431"}, {"e3", "-e412"},
    {"e4", "0"},     {"e41", "0"},    {"e42", "0"},    {"e43", "0"},
    {"e23", "-e41"}, {"e31", "-e42"}, {"e12", "-e43"}, {"e423", "0"},
    {"e431", "0"},   {"e412", "0"},   {"e321", "e4"},  {"e1234", "0"}};
const prd_rules left_weight_dual_pga3dp_rules = {
    {"1", "0"},      {"e1", "0"},     {"e2", "0"},     {"e3", "0"},
    {"e4", "-e321"}, {"e41", "-e23"}, {"e42", "-e31"}, {"e43", "-e12"},
    {"e23", "0"},    {"e31", "0"},    {"e12", "0"},    {"e423", "e1"},
    {"e431", "e2"},  {"e412", "e3"},  {"e321", "0"},   {"e1234", "1"}};

// coefficients needed to create a multivector = [coeff]^T [mv3dp_basis]
const mvec_coeff mv3dp_coeff_A = {"A.c0",  "A.c1",  "A.c2",  "A.c3", "A.c4",  "A.c5",
                                  "A.c6",  "A.c7",  "A.c8",  "A.c9", "A.c10", "A.c11",
                                  "A.c12", "A.c13", "A.c14", "A.c15"};
const mvec_coeff mv3dp_coeff_B = {"B.c0",  "B.c1",  "B.c2",  "B.c3", "B.c4",  "B.c5",
                                  "B.c6",  "B.c7",  "B.c8",  "B.c9", "B.c10", "B.c11",
                                  "B.c12", "B.c13", "B.c14", "B.c15"};
const mvec_coeff mv3dp_coeff_M = {"M.c0",  "M.c1",  "M.c2",  "M.c3", "M.c4",  "M.c5",
                                  "M.c6",  "M.c7",  "M.c8",  "M.c9", "M.c10", "M.c11",
                                  "M.c12", "M.c13", "M.c14", "M.c15"};
const mvec_coeff mv3dp_coeff_M1 = {
    "M1.c0", "M1.c1", "M1.c2",  "M1.c3",  "M1.c4",  "M1.c5",  "M1.c6",  "M1.c7",
    "M1.c8", "M1.c9", "M1.c10", "M1.c11", "M1.c12", "M1.c13", "M1.c14", "M1.c15"};
const mvec_coeff mv3dp_coeff_M2 = {
    "M2.c0", "M2.c1", "M2.c2",  "M2.c3",  "M2.c4",  "M2.c5",  "M2.c6",  "M2.c7",
    "M2.c8", "M2.c9", "M2.c10", "M2.c11", "M2.c12", "M2.c13", "M2.c14", "M2.c15"};
const mvec_coeff mv3dp_coeff_M_even = {"M.c0", "0",    "0",    "0",    "0",    "M.c1",
                                       "M.c2", "M.c3", "M.c4", "M.c5", "M.c6", "0",
                                       "0",    "0",    "0",    "M.c7"};
const mvec_coeff mv3dp_coeff_M_odd = {"0",    "M.c0", "M.c1", "M.c2", "M.c3", "0",
                                      "0",    "0",    "0",    "0",    "0",    "M.c4",
                                      "M.c5", "M.c6", "M.c7", "0"};
const mvec_coeff mv3dp_coeff_A_even = {"A.c0", "0",    "0",    "0",    "0",    "A.c1",
                                       "A.c2", "A.c3", "A.c4", "A.c5", "A.c6", "0",
                                       "0",    "0",    "0",    "A.c7"};
const mvec_coeff mv3dp_coeff_B_even = {"B.c0", "0",    "0",    "0",    "0",    "B.c1",
                                       "B.c2", "B.c3", "B.c4", "B.c5", "B.c6", "0",
                                       "0",    "0",    "0",    "B.c7"};
const mvec_coeff mv3dp_coeff_R_even = {"R.c0", "0",    "0",    "0",    "0",    "R.c1",
                                       "R.c2", "R.c3", "R.c4", "R.c5", "R.c6", "0",
                                       "0",    "0",    "0",    "R.c7"};
const mvec_coeff mv3dp_coeff_R_rev_even = {
    "R.c0",  "0",     "0",     "0", "0", "-R.c1", "-R.c2", "-R.c3",
    "-R.c4", "-R.c5", "-R.c6", "0", "0", "0",     "0",     "R.c7"};
const mvec_coeff mv3dp_coeff_R_rrev_even = {
    "R.c0",  "0",     "0",     "0", "0", "-R.c1", "-R.c2", "-R.c3",
    "-R.c4", "-R.c5", "-R.c6", "0", "0", "0",     "0",     "R.c7"};
const mvec_coeff mv3dp_coeff_A_odd = {"0",    "A.c0", "A.c1", "A.c2", "A.c3", "0",
                                      "0",    "0",    "0",    "0",    "0",    "A.c4",
                                      "A.c5", "A.c6", "A.c7", "0"};
const mvec_coeff mv3dp_coeff_B_odd = {"0",    "B.c0", "B.c1", "B.c2", "B.c3", "0",
                                      "0",    "0",    "0",    "0",    "0",    "B.c4",
                                      "B.c5", "B.c6", "B.c7", "0"};
const mvec_coeff mv3dp_coeff_R_odd = {"0",    "R.c0", "R.c1", "R.c2", "R.c3", "0",
                                      "0",    "0",    "0",    "0",    "0",    "R.c4",
                                      "R.c5", "R.c6", "R.c7", "0"};
const mvec_coeff mv3dp_coeff_R_rev_odd = {
    "0", "R.c0", "R.c1", "R.c2",  "R.c3",  "0",     "0",     "0",
    "0", "0",    "0",    "-R.c4", "-R.c5", "-R.c6", "-R.c7", "0"};
const mvec_coeff mv3dp_coeff_R_rrev_odd = {
    "0", "-R.c0", "-R.c1", "-R.c2", "-R.c3", "0",    "0",    "0",
    "0", "0",     "0",     "R.c4",  "R.c5",  "R.c6", "R.c7", "0"};
const mvec_coeff mv3dp_coeff_svBtps = {"s",    "v.x",  "v.y",  "v.z",  "v.w",  "B.vx",
                                       "B.vy", "B.vz", "B.mx", "B.my", "B.mz", "t.x",
                                       "t.y",  "t.z",  "t.w",  "ps"};
const mvec_coeff mv3dp_coeff_svBtps1 = {
    "s1",    "v1.x",  "v1.y",  "v1.z", "v1.w", "B1.vx", "B1.vy", "B1.vz",
    "B1.mx", "B1.my", "B1.mz", "t1.x", "t1.y", "t1.z",  "t1.w",  "ps1"};
const mvec_coeff mv3dp_coeff_svBtps2 = {
    "s2",    "v2.x",  "v2.y",  "v2.z", "v2.w", "B2.vx", "B2.vy", "B2.vz",
    "B2.mx", "B2.my", "B2.mz", "t2.x", "t2.y", "t2.z",  "t2.w",  "ps2"};
