#pragma once

// Copyright 2024-2025, Daniel Hug. All rights reserved.

#include "ga_prdxpr_common.hpp"

// sta3d: space-time geometric algebra with (g is short for gamma)
//        g0*g0 = +1, g1*g1 = -1, g2*g2 = -1, g3*g3 = -1
//
//        g0         ... time-like dimension
//        g1, g2, g3 ... space-like dimensions
//
// G(1,3,0)

// multivector basis components
const mvec_coeff mvsta3d_basis = {"1",    "g0",   "g1",   "g2",   "g3",  "g01",
                                  "g02",  "g03",  "g23",  "g31",  "g12", "g023",
                                  "g031", "g012", "g123", "g0123"};

// rules to create produc tables (must contain space_str around operator_str on each side)
const prd_rules gpr_sta3d_rules = {
    {"1 * 1", "1"},          {"1 * g0", "g0"},        {"1 * g1", "g1"},
    {"1 * g2", "g2"},        {"1 * g3", "g3"},        {"1 * g01", "g01"},
    {"1 * g02", "g02"},      {"1 * g03", "g03"},      {"1 * g23", "g23"},
    {"1 * g31", "g31"},      {"1 * g12", "g12"},      {"1 * g023", "g023"},
    {"1 * g031", "g031"},    {"1 * g012", "g012"},    {"1 * g123", "g123"},
    {"1 * g0123", "g0123"},

    {"g0 * 1", "g0"},        {"g0 * g1", "g01"},      {"g0 * g2", "g02"},
    {"g0 * g3", "g03"},      {"g0 * g0", "1"},        {"g0 * g01", "g1"},
    {"g0 * g02", "g2"},      {"g0 * g03", "g3"},      {"g0 * g23", "g023"},
    {"g0 * g31", "g031"},    {"g0 * g12", "g012"},    {"g0 * g023", "g23"},
    {"g0 * g031", "g31"},    {"g0 * g012", "g12"},    {"g0 * g123", "g0123"},
    {"g0 * g0123", "g123"},

    {"g1 * 1", "g1"},        {"g1 * g1", "-1"},       {"g1 * g2", "g12"},
    {"g1 * g3", "-g31"},     {"g1 * g0", "-g01"},     {"g1 * g01", "g0"},
    {"g1 * g02", "-g012"},   {"g1 * g03", "g031"},    {"g1 * g23", "g123"},
    {"g1 * g31", "g3"},      {"g1 * g12", "-g2"},     {"g1 * g023", "-g0123"},
    {"g1 * g031", "-g03"},   {"g1 * g012", "g02"},    {"g1 * g123", "-g23"},
    {"g1 * g0123", "g023"},

    {"g2 * 1", "g2"},        {"g2 * g1", "-g12"},     {"g2 * g2", "-1"},
    {"g2 * g3", "g23"},      {"g2 * g0", "-g02"},     {"g2 * g01", "g012"},
    {"g2 * g02", "g0"},      {"g2 * g03", "-g023"},   {"g2 * g23", "-g3"},
    {"g2 * g31", "g123"},    {"g2 * g12", "g1"},      {"g2 * g023", "g03"},
    {"g2 * g031", "-g0123"}, {"g2 * g012", "-g01"},   {"g2 * g123", "-g31"},
    {"g2 * g0123", "g031"},

    {"g3 * 1", "g3"},        {"g3 * g1", "g31"},      {"g3 * g2", "-g23"},
    {"g3 * g3", "-1"},       {"g3 * g0", "-g03"},     {"g3 * g01", "-g031"},
    {"g3 * g02", "g023"},    {"g3 * g03", "g0"},      {"g3 * g23", "g2"},
    {"g3 * g31", "-g1"},     {"g3 * g12", "g123"},    {"g3 * g023", "-g02"},
    {"g3 * g031", "g01"},    {"g3 * g012", "-g0123"}, {"g3 * g123", "-g12"},
    {"g3 * g0123", "g012"},

    {"g01 * 1", "g01"},      {"g01 * g1", "-g0"},     {"g01 * g2", "g012"},
    {"g01 * g3", "-g031"},   {"g01 * g0", "-g1"},     {"g01 * g01", "1"},
    {"g01 * g02", "-g12"},   {"g01 * g03", "g31"},    {"g01 * g23", "g0123"},
    {"g01 * g31", "g03"},    {"g01 * g12", "-g02"},   {"g01 * g023", "-g123"},
    {"g01 * g031", "-g3"},   {"g01 * g012", "g2"},    {"g01 * g123", "-g023"},
    {"g01 * g0123", "g23"},

    {"g02 * 1", "g02"},      {"g02 * g1", "-g012"},   {"g02 * g2", "-g0"},
    {"g02 * g3", "g023"},    {"g02 * g0", "-g2"},     {"g02 * g01", "g12"},
    {"g02 * g02", "1"},      {"g02 * g03", "-g23"},   {"g02 * g23", "-g03"},
    {"g02 * g31", "g0123"},  {"g02 * g12", "g01"},    {"g02 * g023", "g3"},
    {"g02 * g031", "-g123"}, {"g02 * g012", "-g1"},   {"g02 * g123", "-g031"},
    {"g02 * g0123", "g31"},

    {"g03 * 1", "g03"},      {"g03 * g1", "g031"},    {"g03 * g2", "-g023"},
    {"g03 * g3", "-g0"},     {"g03 * g0", "-g3"},     {"g03 * g01", "-g31"},
    {"g03 * g02", "g23"},    {"g03 * g03", "1"},      {"g03 * g23", "g02"},
    {"g03 * g31", "-g01"},   {"g03 * g12", "g0123"},  {"g03 * g023", "-g2"},
    {"g03 * g031", "g1"},    {"g03 * g012", "-g123"}, {"g03 * g123", "-g012"},
    {"g03 * g0123", "g12"},

    {"g23 * 1", "g23"},      {"g23 * g1", "g123"},    {"g23 * g2", "g3"},
    {"g23 * g3", "-g2"},     {"g23 * g0", "g023"},    {"g23 * g01", "g0123"},
    {"g23 * g02", "g03"},    {"g23 * g03", "-g02"},   {"g23 * g23", "-1"},
    {"g23 * g31", "g12"},    {"g23 * g12", "-g31"},   {"g23 * g023", "-g0"},
    {"g23 * g031", "g012"},  {"g23 * g012", "-g031"}, {"g23 * g123", "-g1"},
    {"g23 * g0123", "-g01"},

    {"g31 * 1", "g31"},      {"g31 * g1", "-g3"},     {"g31 * g2", "g123"},
    {"g31 * g3", "g1"},      {"g31 * g0", "g031"},    {"g31 * g01", "-g03"},
    {"g31 * g02", "g0123"},  {"g31 * g03", "g01"},    {"g31 * g23", "-g12"},
    {"g31 * g31", "-1"},     {"g31 * g12", "g23"},    {"g31 * g023", "-g012"},
    {"g31 * g031", "-g0"},   {"g31 * g012", "g023"},  {"g31 * g123", "-g2"},
    {"g31 * g0123", "-g02"},

    {"g12 * 1", "g12"},      {"g12 * g1", "g2"},      {"g12 * g2", "-g1"},
    {"g12 * g3", "g123"},    {"g12 * g0", "g012"},    {"g12 * g01", "g02"},
    {"g12 * g02", "-g01"},   {"g12 * g03", "g0123"},  {"g12 * g23", "g31"},
    {"g12 * g31", "-g23"},   {"g12 * g12", "-1"},     {"g12 * g023", "g031"},
    {"g12 * g031", "-g023"}, {"g12 * g012", "-g0"},   {"g12 * g123", "-g3"},
    {"g12 * g0123", "-g03"},

    {"g023 * 1", "g023"},    {"g023 * g1", "g0123"},  {"g023 * g2", "g03"},
    {"g023 * g3", "-g02"},   {"g023 * g0", "g23"},    {"g023 * g01", "g123"},
    {"g023 * g02", "g3"},    {"g023 * g03", "-g2"},   {"g023 * g23", "-g0"},
    {"g023 * g31", "g012"},  {"g023 * g12", "-g031"}, {"g023 * g023", "-1"},
    {"g023 * g031", "g12"},  {"g023 * g012", "-g31"}, {"g023 * g123", "-g01"},
    {"g023 * g0123", "-g1"},

    {"g031 * 1", "g031"},    {"g031 * g1", "-g03"},   {"g031 * g2", "g0123"},
    {"g031 * g3", "g01"},    {"g031 * g0", "g31"},    {"g031 * g01", "-g3"},
    {"g031 * g02", "g123"},  {"g031 * g03", "g1"},    {"g031 * g23", "-g012"},
    {"g031 * g31", "-g0"},   {"g031 * g12", "g023"},  {"g031 * g023", "-g12"},
    {"g031 * g031", "-1"},   {"g031 * g012", "g23"},  {"g031 * g123", "-g02"},
    {"g031 * g0123", "-g2"},

    {"g012 * 1", "g012"},    {"g012 * g1", "g02"},    {"g012 * g2", "-g01"},
    {"g012 * g3", "g0123"},  {"g012 * g0", "g12"},    {"g012 * g01", "g2"},
    {"g012 * g02", "-g1"},   {"g012 * g03", "g123"},  {"g012 * g23", "g031"},
    {"g012 * g31", "-g023"}, {"g012 * g12", "-g0"},   {"g012 * g023", "g31"},
    {"g012 * g031", "-g23"}, {"g012 * g012", "-1"},   {"g012 * g123", "-g03"},
    {"g012 * g0123", "-g3"},

    {"g123 * 1", "g123"},    {"g123 * g1", "-g23"},   {"g123 * g2", "-g31"},
    {"g123 * g3", "-g12"},   {"g123 * g0", "-g0123"}, {"g123 * g01", "g023"},
    {"g123 * g02", "g031"},  {"g123 * g03", "g012"},  {"g123 * g23", "-g1"},
    {"g123 * g31", "-g2"},   {"g123 * g12", "-g3"},   {"g123 * g023", "g01"},
    {"g123 * g031", "g02"},  {"g123 * g012", "g03"},  {"g123 * g123", "1"},
    {"g123 * g0123", "-g0"},

    {"g0123 * 1", "g0123"},  {"g0123 * g1", "-g023"}, {"g0123 * g2", "-g031"},
    {"g0123 * g3", "-g012"}, {"g0123 * g0", "-g123"}, {"g0123 * g01", "g23"},
    {"g0123 * g02", "g31"},  {"g0123 * g03", "g12"},  {"g0123 * g23", "-g01"},
    {"g0123 * g31", "-g02"}, {"g0123 * g12", "-g03"}, {"g0123 * g023", "g1"},
    {"g0123 * g031", "g2"},  {"g0123 * g012", "g3"},  {"g0123 * g123", "g0"},
    {"g0123 * g0123", "-1"}};


const prd_rules wdg_sta3d_rules = {
    {"1 ^ 1", "1"},          {"1 ^ g0", "g0"},        {"1 ^ g1", "g1"},
    {"1 ^ g2", "g2"},        {"1 ^ g3", "g3"},        {"1 ^ g01", "g01"},
    {"1 ^ g02", "g02"},      {"1 ^ g03", "g03"},      {"1 ^ g23", "g23"},
    {"1 ^ g31", "g31"},      {"1 ^ g12", "g12"},      {"1 ^ g023", "g023"},
    {"1 ^ g031", "g031"},    {"1 ^ g012", "g012"},    {"1 ^ g123", "g123"},
    {"1 ^ g0123", "g0123"},

    {"g1 ^ 1", "g1"},        {"g1 ^ g0", "-g01"},     {"g1 ^ g1", "0"},
    {"g1 ^ g2", "g12"},      {"g1 ^ g3", "-g31"},     {"g1 ^ g01", "0"},
    {"g1 ^ g02", "-g012"},   {"g1 ^ g03", "g031"},    {"g1 ^ g23", "g123"},
    {"g1 ^ g31", "0"},       {"g1 ^ g12", "0"},       {"g1 ^ g023", "-g0123"},
    {"g1 ^ g031", "0"},      {"g1 ^ g012", "0"},      {"g1 ^ g123", "0"},
    {"g1 ^ g0123", "0"},

    {"g2 ^ 1", "g2"},        {"g2 ^ g0", "-g02"},     {"g2 ^ g1", "-g12"},
    {"g2 ^ g2", "0"},        {"g2 ^ g3", "g23"},      {"g2 ^ g01", "g012"},
    {"g2 ^ g02", "0"},       {"g2 ^ g03", "-g023"},   {"g2 ^ g23", "0"},
    {"g2 ^ g31", "g123"},    {"g2 ^ g12", "0"},       {"g2 ^ g023", "0"},
    {"g2 ^ g031", "-g0123"}, {"g2 ^ g012", "0"},      {"g2 ^ g123", "0"},
    {"g2 ^ g0123", "0"},

    {"g3 ^ 1", "g3"},        {"g3 ^ g0", "-g03"},     {"g3 ^ g1", "g31"},
    {"g3 ^ g2", "-g23"},     {"g3 ^ g3", "0"},        {"g3 ^ g01", "-g031"},
    {"g3 ^ g02", "g023"},    {"g3 ^ g03", "0"},       {"g3 ^ g23", "0"},
    {"g3 ^ g31", "0"},       {"g3 ^ g12", "g123"},    {"g3 ^ g023", "0"},
    {"g3 ^ g031", "0"},      {"g3 ^ g012", "-g0123"}, {"g3 ^ g123", "0"},
    {"g3 ^ g0123", "0"},

    {"g0 ^ 1", "g0"},        {"g0 ^ g0", "0"},        {"g0 ^ g1", "g01"},
    {"g0 ^ g2", "g02"},      {"g0 ^ g3", "g03"},      {"g0 ^ g01", "0"},
    {"g0 ^ g02", "0"},       {"g0 ^ g03", "0"},       {"g0 ^ g23", "g023"},
    {"g0 ^ g31", "g031"},    {"g0 ^ g12", "g012"},    {"g0 ^ g023", "0"},
    {"g0 ^ g031", "0"},      {"g0 ^ g012", "0"},      {"g0 ^ g123", "g0123"},
    {"g0 ^ g0123", "0"},

    {"g01 ^ 1", "g01"},      {"g01 ^ g0", "0"},       {"g01 ^ g1", "0"},
    {"g01 ^ g2", "g012"},    {"g01 ^ g3", "-g031"},   {"g01 ^ g01", "0"},
    {"g01 ^ g02", "0"},      {"g01 ^ g03", "0"},      {"g01 ^ g23", "g0123"},
    {"g01 ^ g31", "0"},      {"g01 ^ g12", "0"},      {"g01 ^ g023", "0"},
    {"g01 ^ g031", "0"},     {"g01 ^ g012", "0"},     {"g01 ^ g123", "0"},
    {"g01 ^ g0123", "0"},

    {"g02 ^ 1", "g02"},      {"g02 ^ g0", "0"},       {"g02 ^ g1", "-g012"},
    {"g02 ^ g2", "0"},       {"g02 ^ g3", "g023"},    {"g02 ^ g01", "0"},
    {"g02 ^ g02", "0"},      {"g02 ^ g03", "0"},      {"g02 ^ g23", "0"},
    {"g02 ^ g31", "g0123"},  {"g02 ^ g12", "0"},      {"g02 ^ g023", "0"},
    {"g02 ^ g031", "0"},     {"g02 ^ g012", "0"},     {"g02 ^ g123", "0"},
    {"g02 ^ g0123", "0"},

    {"g03 ^ 1", "g03"},      {"g03 ^ g0", "0"},       {"g03 ^ g1", "g031"},
    {"g03 ^ g2", "-g023"},   {"g03 ^ g3", "0"},       {"g03 ^ g01", "0"},
    {"g03 ^ g02", "0"},      {"g03 ^ g03", "0"},      {"g03 ^ g23", "0"},
    {"g03 ^ g31", "0"},      {"g03 ^ g12", "g0123"},  {"g03 ^ g023", "0"},
    {"g03 ^ g031", "0"},     {"g03 ^ g012", "0"},     {"g03 ^ g123", "0"},
    {"g03 ^ g0123", "0"},

    {"g23 ^ 1", "g23"},      {"g23 ^ g0", "g023"},    {"g23 ^ g1", "g123"},
    {"g23 ^ g2", "0"},       {"g23 ^ g3", "0"},       {"g23 ^ g01", "g0123"},
    {"g23 ^ g02", "0"},      {"g23 ^ g03", "0"},      {"g23 ^ g23", "0"},
    {"g23 ^ g31", "0"},      {"g23 ^ g12", "0"},      {"g23 ^ g023", "0"},
    {"g23 ^ g031", "0"},     {"g23 ^ g012", "0"},     {"g23 ^ g123", "0"},
    {"g23 ^ g0123", "0"},

    {"g31 ^ 1", "g31"},      {"g31 ^ g0", "g031"},    {"g31 ^ g1", "0"},
    {"g31 ^ g2", "g123"},    {"g31 ^ g3", "0"},       {"g31 ^ g01", "0"},
    {"g31 ^ g02", "g0123"},  {"g31 ^ g03", "0"},      {"g31 ^ g23", "0"},
    {"g31 ^ g31", "0"},      {"g31 ^ g12", "0"},      {"g31 ^ g023", "0"},
    {"g31 ^ g031", "0"},     {"g31 ^ g012", "0"},     {"g31 ^ g123", "0"},
    {"g31 ^ g0123", "0"},

    {"g12 ^ 1", "g12"},      {"g12 ^ g0", "g012"},    {"g12 ^ g1", "0"},
    {"g12 ^ g2", "0"},       {"g12 ^ g3", "g123"},    {"g12 ^ g01", "0"},
    {"g12 ^ g02", "0"},      {"g12 ^ g03", "g0123"},  {"g12 ^ g23", "0"},
    {"g12 ^ g31", "0"},      {"g12 ^ g12", "0"},      {"g12 ^ g023", "0"},
    {"g12 ^ g031", "0"},     {"g12 ^ g012", "0"},     {"g12 ^ g123", "0"},
    {"g12 ^ g0123", "0"},

    {"g023 ^ 1", "g023"},    {"g023 ^ g0", "0"},      {"g023 ^ g1", "g0123"},
    {"g023 ^ g2", "0"},      {"g023 ^ g3", "0"},      {"g023 ^ g01", "0"},
    {"g023 ^ g02", "0"},     {"g023 ^ g03", "0"},     {"g023 ^ g23", "0"},
    {"g023 ^ g31", "0"},     {"g023 ^ g12", "0"},     {"g023 ^ g023", "0"},
    {"g023 ^ g031", "0"},    {"g023 ^ g012", "0"},    {"g023 ^ g123", "0"},
    {"g023 ^ g0123", "0"},

    {"g031 ^ 1", "g031"},    {"g031 ^ g0", "0"},      {"g031 ^ g1", "0"},
    {"g031 ^ g2", "g0123"},  {"g031 ^ g3", "0"},      {"g031 ^ g01", "0"},
    {"g031 ^ g02", "0"},     {"g031 ^ g03", "0"},     {"g031 ^ g23", "0"},
    {"g031 ^ g31", "0"},     {"g031 ^ g12", "0"},     {"g031 ^ g023", "0"},
    {"g031 ^ g031", "0"},    {"g031 ^ g012", "0"},    {"g031 ^ g123", "0"},
    {"g031 ^ g0123", "0"},

    {"g012 ^ 1", "g012"},    {"g012 ^ g0", "0"},      {"g012 ^ g1", "0"},
    {"g012 ^ g2", "0"},      {"g012 ^ g3", "g0123"},  {"g012 ^ g01", "0"},
    {"g012 ^ g02", "0"},     {"g012 ^ g03", "0"},     {"g012 ^ g23", "0"},
    {"g012 ^ g31", "0"},     {"g012 ^ g12", "0"},     {"g012 ^ g023", "0"},
    {"g012 ^ g031", "0"},    {"g012 ^ g012", "0"},    {"g012 ^ g123", "0"},
    {"g012 ^ g0123", "0"},

    {"g123 ^ 1", "g123"},    {"g123 ^ g0", "-g0123"}, {"g123 ^ g1", "0"},
    {"g123 ^ g2", "0"},      {"g123 ^ g3", "0"},      {"g123 ^ g01", "0"},
    {"g123 ^ g02", "0"},     {"g123 ^ g03", "0"},     {"g123 ^ g23", "0"},
    {"g123 ^ g31", "0"},     {"g123 ^ g12", "0"},     {"g123 ^ g023", "0"},
    {"g123 ^ g031", "0"},    {"g123 ^ g012", "0"},    {"g123 ^ g123", "0"},
    {"g123 ^ g0123", "0"},

    {"g0123 ^ 1", "g0123"},  {"g0123 ^ g0", "0"},     {"g0123 ^ g1", "0"},
    {"g0123 ^ g2", "0"},     {"g0123 ^ g3", "0"},     {"g0123 ^ g01", "0"},
    {"g0123 ^ g02", "0"},    {"g0123 ^ g03", "0"},    {"g0123 ^ g23", "0"},
    {"g0123 ^ g31", "0"},    {"g0123 ^ g12", "0"},    {"g0123 ^ g023", "0"},
    {"g0123 ^ g031", "0"},   {"g0123 ^ g012", "0"},   {"g0123 ^ g123", "0"},
    {"g0123 ^ g0123", "0"}};

const prd_rules dot_sta3d_rules = {
    {"1 * 1", "1"},         {"1 * g0", "0"},       {"1 * g1", "0"},
    {"1 * g2", "0"},        {"1 * g3", "0"},       {"1 * g01", "0"},
    {"1 * g02", "0"},       {"1 * g03", "0"},      {"1 * g23", "0"},
    {"1 * g31", "0"},       {"1 * g12", "0"},      {"1 * g023", "0"},
    {"1 * g031", "0"},      {"1 * g012", "0"},     {"1 * g123", "0"},
    {"1 * g0123", "0"},

    {"g0 * 1", "0"},        {"g0 * g0", "1"},      {"g0 * g1", "0"},
    {"g0 * g2", "0"},       {"g0 * g3", "0"},      {"g0 * g01", "0"},
    {"g0 * g02", "0"},      {"g0 * g03", "0"},     {"g0 * g23", "0"},
    {"g0 * g31", "0"},      {"g0 * g12", "0"},     {"g0 * g023", "0"},
    {"g0 * g031", "0"},     {"g0 * g012", "0"},    {"g0 * g123", "0"},
    {"g0 * g0123", "0"},

    {"g1 * 1", "0"},        {"g1 * g0", "0"},      {"g1 * g1", "-1"},
    {"g1 * g2", "0"},       {"g1 * g3", "0"},      {"g1 * g01", "0"},
    {"g1 * g02", "0"},      {"g1 * g03", "0"},     {"g1 * g23", "0"},
    {"g1 * g31", "0"},      {"g1 * g12", "0"},     {"g1 * g023", "0"},
    {"g1 * g031", "0"},     {"g1 * g012", "0"},    {"g1 * g123", "0"},
    {"g1 * g0123", "0"},

    {"g2 * 1", "0"},        {"g2 * g0", "0"},      {"g2 * g1", "0"},
    {"g2 * g2", "-1"},      {"g2 * g3", "0"},      {"g2 * g01", "0"},
    {"g2 * g02", "0"},      {"g2 * g03", "0"},     {"g2 * g23", "0"},
    {"g2 * g31", "0"},      {"g2 * g12", "0"},     {"g2 * g023", "0"},
    {"g2 * g031", "0"},     {"g2 * g012", "0"},    {"g2 * g123", "0"},
    {"g2 * g0123", "0"},

    {"g3 * 1", "0"},        {"g3 * g0", "0"},      {"g3 * g1", "0"},
    {"g3 * g2", "0"},       {"g3 * g3", "-1"},     {"g3 * g01", "0"},
    {"g3 * g02", "0"},      {"g3 * g03", "0"},     {"g3 * g23", "0"},
    {"g3 * g31", "0"},      {"g3 * g12", "0"},     {"g3 * g023", "0"},
    {"g3 * g031", "0"},     {"g3 * g012", "0"},    {"g3 * g123", "0"},
    {"g3 * g0123", "0"},

    {"g01 * 1", "0"},       {"g01 * g0", "0"},     {"g01 * g1", "0"},
    {"g01 * g2", "0"},      {"g01 * g3", "0"},     {"g01 * g01", "1"},
    {"g01 * g02", "0"},     {"g01 * g03", "0"},    {"g01 * g23", "0"},
    {"g01 * g31", "0"},     {"g01 * g12", "0"},    {"g01 * g023", "0"},
    {"g01 * g031", "0"},    {"g01 * g012", "0"},   {"g01 * g123", "0"},
    {"g01 * g0123", "0"},

    {"g02 * 1", "0"},       {"g02 * g0", "0"},     {"g02 * g1", "0"},
    {"g02 * g2", "0"},      {"g02 * g3", "0"},     {"g02 * g01", "0"},
    {"g02 * g02", "1"},     {"g02 * g03", "0"},    {"g02 * g23", "0"},
    {"g02 * g31", "0"},     {"g02 * g12", "0"},    {"g02 * g023", "0"},
    {"g02 * g031", "0"},    {"g02 * g012", "0"},   {"g02 * g123", "0"},
    {"g02 * g0123", "0"},

    {"g03 * 1", "0"},       {"g03 * g0", "0"},     {"g03 * g1", "0"},
    {"g03 * g2", "0"},      {"g03 * g3", "0"},     {"g03 * g01", "0"},
    {"g03 * g02", "0"},     {"g03 * g03", "1"},    {"g03 * g23", "0"},
    {"g03 * g31", "0"},     {"g03 * g12", "0"},    {"g03 * g023", "0"},
    {"g03 * g031", "0"},    {"g03 * g012", "0"},   {"g03 * g123", "0"},
    {"g03 * g0123", "0"},

    {"g23 * 1", "0"},       {"g23 * g0", "0"},     {"g23 * g1", "0"},
    {"g23 * g2", "0"},      {"g23 * g3", "0"},     {"g23 * g01", "0"},
    {"g23 * g02", "0"},     {"g23 * g03", "0"},    {"g23 * g23", "-1"},
    {"g23 * g31", "0"},     {"g23 * g12", "0"},    {"g23 * g023", "0"},
    {"g23 * g031", "0"},    {"g23 * g012", "0"},   {"g23 * g123", "0"},
    {"g23 * g0123", "0"},

    {"g31 * 1", "0"},       {"g31 * g0", "0"},     {"g31 * g1", "0"},
    {"g31 * g2", "0"},      {"g31 * g3", "0"},     {"g31 * g01", "0"},
    {"g31 * g02", "0"},     {"g31 * g03", "0"},    {"g31 * g23", "0"},
    {"g31 * g31", "-1"},    {"g31 * g12", "0"},    {"g31 * g023", "0"},
    {"g31 * g031", "0"},    {"g31 * g012", "0"},   {"g31 * g123", "0"},
    {"g31 * g0123", "0"},

    {"g12 * 1", "0"},       {"g12 * g0", "0"},     {"g12 * g1", "0"},
    {"g12 * g2", "0"},      {"g12 * g3", "0"},     {"g12 * g01", "0"},
    {"g12 * g02", "0"},     {"g12 * g03", "0"},    {"g12 * g23", "0"},
    {"g12 * g31", "0"},     {"g12 * g12", "-1"},   {"g12 * g023", "0"},
    {"g12 * g031", "0"},    {"g12 * g012", "0"},   {"g12 * g123", "0"},
    {"g12 * g0123", "0"},

    {"g023 * 1", "0"},      {"g023 * g0", "0"},    {"g023 * g1", "0"},
    {"g023 * g2", "0"},     {"g023 * g3", "0"},    {"g023 * g01", "0"},
    {"g023 * g02", "0"},    {"g023 * g03", "0"},   {"g023 * g23", "0"},
    {"g023 * g31", "0"},    {"g023 * g12", "0"},   {"g023 * g023", "-1"},
    {"g023 * g031", "0"},   {"g023 * g012", "0"},  {"g023 * g123", "0"},
    {"g023 * g0123", "0"},

    {"g031 * 1", "0"},      {"g031 * g0", "0"},    {"g031 * g1", "0"},
    {"g031 * g2", "0"},     {"g031 * g3", "0"},    {"g031 * g01", "0"},
    {"g031 * g02", "0"},    {"g031 * g03", "0"},   {"g031 * g23", "0"},
    {"g031 * g31", "0"},    {"g031 * g12", "0"},   {"g031 * g023", "0"},
    {"g031 * g031", "-1"},  {"g031 * g012", "0"},  {"g031 * g123", "0"},
    {"g031 * g0123", "0"},

    {"g012 * 1", "0"},      {"g012 * g0", "0"},    {"g012 * g1", "0"},
    {"g012 * g2", "0"},     {"g012 * g3", "0"},    {"g012 * g01", "0"},
    {"g012 * g02", "0"},    {"g012 * g03", "0"},   {"g012 * g23", "0"},
    {"g012 * g31", "0"},    {"g012 * g12", "0"},   {"g012 * g023", "0"},
    {"g012 * g031", "0"},   {"g012 * g012", "-1"}, {"g012 * g123", "0"},
    {"g012 * g0123", "0"},

    {"g123 * 1", "0"},      {"g123 * g0", "0"},    {"g123 * g1", "0"},
    {"g123 * g2", "0"},     {"g123 * g3", "0"},    {"g123 * g01", "0"},
    {"g123 * g02", "0"},    {"g123 * g03", "0"},   {"g123 * g23", "0"},
    {"g123 * g31", "0"},    {"g123 * g12", "0"},   {"g123 * g023", "0"},
    {"g123 * g031", "0"},   {"g123 * g012", "0"},  {"g123 * g123", "1"},
    {"g123 * g0123", "0"},

    {"g0123 * 1", "0"},     {"g0123 * g0", "0"},   {"g0123 * g1", "0"},
    {"g0123 * g2", "0"},    {"g0123 * g3", "0"},   {"g0123 * g01", "0"},
    {"g0123 * g02", "0"},   {"g0123 * g03", "0"},  {"g0123 * g23", "0"},
    {"g0123 * g31", "0"},   {"g0123 * g12", "0"},  {"g0123 * g023", "0"},
    {"g0123 * g031", "0"},  {"g0123 * g012", "0"}, {"g0123 * g123", "0"},
    {"g0123 * g0123", "-1"}};


// checked up to here ^^^ ------------------------------------------------------------
// below there is old input copied from pga3dp, but not yet adjusted for STA3D

// TODO: modify for STA3D starting here

// complement in sta3d: lcmpl(rcmpl(u)) = u
// lcmpl:  lcmpl(u) ^ u        = g0123
const prd_rules lcmpl_sta3d_rules = {
    {"1", "g0123"},  {"g1", "-g023"}, {"g2", "-g031"}, {"g3", "-g012"},
    {"g0", "-g123"}, {"g01", "-g23"}, {"g02", "-g31"}, {"g03", "-g12"},
    {"g23", "-g01"}, {"g31", "-g02"}, {"g12", "-g03"}, {"g023", "g1"},
    {"g031", "g2"},  {"g012", "g3"},  {"g123", "g0"},  {"g0123", "1"}};
// rcmpl:  u        ^ rcmpl(u) = g0123
const prd_rules rcmpl_sta3d_rules = {
    {"1", "g0123"},  {"g1", "g023"},  {"g2", "g031"},  {"g3", "g012"},
    {"g0", "g123"},  {"g01", "-g23"}, {"g02", "-g31"}, {"g03", "-g12"},
    {"g23", "-g01"}, {"g31", "-g02"}, {"g12", "-g03"}, {"g023", "-g1"},
    {"g031", "-g2"}, {"g012", "-g3"}, {"g123", "-g0"}, {"g0123", "1"}};

// rules needed to derive contractions and expansions using bulk_dual and weight_dual
// (derived from the right complement -> right bulk dual is equivalent to the Hodge dual)
const prd_rules right_bulk_dual_sta3d_rules = {
    {"1", "g0123"},  {"g1", "g023"},  {"g2", "g031"},  {"g3", "g012"},
    {"g0", "0"},     {"g01", "0"},    {"g02", "0"},    {"g03", "0"},
    {"g23", "-g01"}, {"g31", "-g02"}, {"g12", "-g03"}, {"g023", "0"},
    {"g031", "0"},   {"g012", "0"},   {"g123", "-g0"}, {"g0123", "0"}};
const prd_rules right_weight_dual_sta3d_rules = {
    {"1", "0"},      {"g1", "0"},     {"g2", "0"},     {"g3", "0"},
    {"g0", "g123"},  {"g01", "-g23"}, {"g02", "-g31"}, {"g03", "-g12"},
    {"g23", "0"},    {"g31", "0"},    {"g12", "0"},    {"g023", "-g1"},
    {"g031", "-g2"}, {"g012", "-g3"}, {"g123", "0"},   {"g0123", "1"}};

// (derived from the left complement)
const prd_rules left_bulk_dual_sta3d_rules = {
    {"1", "g0123"},  {"g1", "-g023"}, {"g2", "-g031"}, {"g3", "-g012"},
    {"g0", "0"},     {"g01", "0"},    {"g02", "0"},    {"g03", "0"},
    {"g23", "-g01"}, {"g31", "-g02"}, {"g12", "-g03"}, {"g023", "0"},
    {"g031", "0"},   {"g012", "0"},   {"g123", "g0"},  {"g0123", "0"}};
const prd_rules left_weight_dual_sta3d_rules = {
    {"1", "0"},      {"g1", "0"},     {"g2", "0"},     {"g3", "0"},
    {"g0", "-g123"}, {"g01", "-g23"}, {"g02", "-g31"}, {"g03", "-g12"},
    {"g23", "0"},    {"g31", "0"},    {"g12", "0"},    {"g023", "g1"},
    {"g031", "g2"},  {"g012", "g3"},  {"g123", "0"},   {"g0123", "1"}};

// coefficients needed to create a multivector = [coeff]^T [mvsta3d_basis]
const mvec_coeff mvsta3d_coeff_A = {"A.c0",  "A.c1",  "A.c2",  "A.c3", "A.c4",  "A.c5",
                                    "A.c6",  "A.c7",  "A.c8",  "A.c9", "A.c10", "A.c11",
                                    "A.c12", "A.c13", "A.c14", "A.c15"};
const mvec_coeff mvsta3d_coeff_B = {"B.c0",  "B.c1",  "B.c2",  "B.c3", "B.c4",  "B.c5",
                                    "B.c6",  "B.c7",  "B.c8",  "B.c9", "B.c10", "B.c11",
                                    "B.c12", "B.c13", "B.c14", "B.c15"};
const mvec_coeff mvsta3d_coeff_M = {"M.c0",  "M.c1",  "M.c2",  "M.c3", "M.c4",  "M.c5",
                                    "M.c6",  "M.c7",  "M.c8",  "M.c9", "M.c10", "M.c11",
                                    "M.c12", "M.c13", "M.c14", "M.c15"};
const mvec_coeff mvsta3d_coeff_M1 = {
    "M1.c0", "M1.c1", "M1.c2",  "M1.c3",  "M1.c4",  "M1.c5",  "M1.c6",  "M1.c7",
    "M1.c8", "M1.c9", "M1.c10", "M1.c11", "M1.c12", "M1.c13", "M1.c14", "M1.c15"};
const mvec_coeff mvsta3d_coeff_M2 = {
    "M2.c0", "M2.c1", "M2.c2",  "M2.c3",  "M2.c4",  "M2.c5",  "M2.c6",  "M2.c7",
    "M2.c8", "M2.c9", "M2.c10", "M2.c11", "M2.c12", "M2.c13", "M2.c14", "M2.c15"};
const mvec_coeff mvsta3d_coeff_M_even = {"M.c0", "0",    "0",    "0",    "0",    "M.c1",
                                         "M.c2", "M.c3", "M.c4", "M.c5", "M.c6", "0",
                                         "0",    "0",    "0",    "M.c7"};
const mvec_coeff mvsta3d_coeff_M_odd = {"0",    "M.c0", "M.c1", "M.c2", "M.c3", "0",
                                        "0",    "0",    "0",    "0",    "0",    "M.c4",
                                        "M.c5", "M.c6", "M.c7", "0"};
const mvec_coeff mvsta3d_coeff_A_even = {"A.c0", "0",    "0",    "0",    "0",    "A.c1",
                                         "A.c2", "A.c3", "A.c4", "A.c5", "A.c6", "0",
                                         "0",    "0",    "0",    "A.c7"};
const mvec_coeff mvsta3d_coeff_B_even = {"B.c0", "0",    "0",    "0",    "0",    "B.c1",
                                         "B.c2", "B.c3", "B.c4", "B.c5", "B.c6", "0",
                                         "0",    "0",    "0",    "B.c7"};
const mvec_coeff mvsta3d_coeff_R_even = {"R.c0", "0",    "0",    "0",    "0",    "R.c1",
                                         "R.c2", "R.c3", "R.c4", "R.c5", "R.c6", "0",
                                         "0",    "0",    "0",    "R.c7"};
const mvec_coeff mvsta3d_coeff_R_rev_even = {
    "R.c0",  "0",     "0",     "0", "0", "-R.c1", "-R.c2", "-R.c3",
    "-R.c4", "-R.c5", "-R.c6", "0", "0", "0",     "0",     "R.c7"};
const mvec_coeff mvsta3d_coeff_R_rrev_even = {
    "R.c0",  "0",     "0",     "0", "0", "-R.c1", "-R.c2", "-R.c3",
    "-R.c4", "-R.c5", "-R.c6", "0", "0", "0",     "0",     "R.c7"};
const mvec_coeff mvsta3d_coeff_A_odd = {"0",    "A.c0", "A.c1", "A.c2", "A.c3", "0",
                                        "0",    "0",    "0",    "0",    "0",    "A.c4",
                                        "A.c5", "A.c6", "A.c7", "0"};
const mvec_coeff mvsta3d_coeff_B_odd = {"0",    "B.c0", "B.c1", "B.c2", "B.c3", "0",
                                        "0",    "0",    "0",    "0",    "0",    "B.c4",
                                        "B.c5", "B.c6", "B.c7", "0"};
const mvec_coeff mvsta3d_coeff_R_odd = {"0",    "R.c0", "R.c1", "R.c2", "R.c3", "0",
                                        "0",    "0",    "0",    "0",    "0",    "R.c4",
                                        "R.c5", "R.c6", "R.c7", "0"};
const mvec_coeff mvsta3d_coeff_R_rev_odd = {
    "0", "R.c0", "R.c1", "R.c2",  "R.c3",  "0",     "0",     "0",
    "0", "0",    "0",    "-R.c4", "-R.c5", "-R.c6", "-R.c7", "0"};
const mvec_coeff mvsta3d_coeff_R_rrev_odd = {
    "0", "-R.c0", "-R.c1", "-R.c2", "-R.c3", "0",    "0",    "0",
    "0", "0",     "0",     "R.c4",  "R.c5",  "R.c6", "R.c7", "0"};
const mvec_coeff mvsta3d_coeff_svBtps = {"s",    "v.x",  "v.y",  "v.z",  "v.w",  "B.vx",
                                         "B.vy", "B.vz", "B.mx", "B.my", "B.mz", "t.x",
                                         "t.y",  "t.z",  "t.w",  "ps"};
const mvec_coeff mvsta3d_coeff_svBtps1 = {
    "s1",    "v1.x",  "v1.y",  "v1.z", "v1.w", "B1.vx", "B1.vy", "B1.vz",
    "B1.mx", "B1.my", "B1.mz", "t1.x", "t1.y", "t1.z",  "t1.w",  "ps1"};
const mvec_coeff mvsta3d_coeff_svBtps2 = {
    "s2",    "v2.x",  "v2.y",  "v2.z", "v2.w", "B2.vx", "B2.vy", "B2.vz",
    "B2.mx", "B2.my", "B2.mz", "t2.x", "t2.y", "t2.z",  "t2.w",  "ps2"};
